(this.webpackJsonpseis=this.webpackJsonpseis||[]).push([[0],{107:function(e,n,t){e.exports=t(152)},112:function(e,n,t){},118:function(e,n,t){},148:function(e,n){},152:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),i=t(14),o=t.n(i);t(112),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=t(8),s=t.n(c),l=t(10),u=t(19),d=t(60),f=t(73),m="https://seis-game.herokuapp.com";function p(e){return new Promise((function(n){return setTimeout(n,e)}))}function v(e){return h.apply(this,arguments)}function h(){return(h=Object(l.a)(s.a.mark((function e(n){var t,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(m+"/games/seis/"+n);case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Room ".concat(n," not found"));case 5:return e.next=7,p(1e3);case 7:return e.next=9,t.json();case 9:return a=e.sent,e.abrupt("return",a);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,n,t){return b.apply(this,arguments)}function b(){return(b=Object(l.a)(s.a.mark((function e(n,t,a){var r,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(1e3);case 2:return e.next=4,fetch(m+"/games/seis/"+n+"/join",{method:"POST",body:JSON.stringify({playerID:a,playerName:t}),headers:{"Content-Type":"application/json"}});case 4:if((r=e.sent).ok){e.next=7;break}throw new Error("Unable to join room ".concat(n));case 7:return e.next=9,p(1e3);case 9:return e.next=11,r.json();case 11:return i=e.sent,e.abrupt("return",i.playerCredentials);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var g,E=t(4),y=t(2),x=t(11),j=t.n(x);!function(e){e.CIRCUIT="C",e.HOME="H",e.START="S"}(g||(g={}));function S(e,n,t){return(e+n.toString(16)+t.toString(16)).toUpperCase()}var O=j.a.curry(S)(g.HOME),k=j.a.curry(S)(g.CIRCUIT),C=j.a.curry(S)(g.START);function I(e,n){var t,a={type:(t=e)[0],seat:parseInt(t[1],16),index:parseInt(t[2],16)};if(R(e))return k(a.seat,0);if(function(e){return"C"===e[0].toUpperCase()}(e)){if(a.index<11)return k(a.seat,a.index+1);var r=(a.seat+1)%4;return r===n?O(r,0):k(r,0)}return function(e){return"H"===e[0].toUpperCase()}(e)&&a.index<3?O(a.seat,a.index+1):y.f}function N(e,n,t){var a,r,i=t.find((function(n){return n.position===e}));if("undefined"===typeof i)throw new Error("No piece in that position");if(R(e)&&![1,6].includes(n))return y.f;try{if((a=j.a.range(n).reduce((function(e,n){var a=I(e,i.seat);if(a===y.f)throw y.f;if(function(e,n,t){return e.some(j.a.matches({position:t,seat:n}))}(t,i.seat,a))throw y.f;return a}),e))===e)return e}catch(o){return y.f}return"C"===(r=a)[0].toUpperCase()&&"5"===r[2]&&t.find((function(e){return a===e.position}))?y.f:a}function D(e,n,t){var a=N(e,n,t);if(a===y.f)throw new Error("invalid move");var r={};r[e]=a;var i=t.find(j.a.matches({position:a}));return i&&(r[i.position]=function(e,n){var t=j.a.first(j.a.difference(j.a.range(4).map((function(e){return C(n,e)})),e.map((function(e){return e.position}))));if(!t)throw new Error("cannot capture");return t}(t,i.seat)),r}function R(e){return"S"===e[0].toUpperCase()}var T={pieces:[{seat:0,position:"S00"},{seat:0,position:"S01"},{seat:0,position:"S02"},{seat:0,position:"S03"},{seat:1,position:"S10"},{seat:1,position:"S11"},{seat:1,position:"S12"},{seat:1,position:"S13"},{seat:2,position:"S20"},{seat:2,position:"S21"},{seat:2,position:"S22"},{seat:2,position:"S23"},{seat:3,position:"S30"},{seat:3,position:"S31"},{seat:3,position:"S32"},{seat:3,position:"S33"}],players:[{id:"0",seat:0,name:"Player 1",color:"red"},{id:"1",seat:1,name:"Player 2",color:"blue"},{id:"2",seat:2,name:"Player 3",color:"yellow"},{id:"3",seat:3,name:"Player 4",color:"green"}]};function B(e,n){var t=e.players.find(j.a.matches({seat:n}));if(void 0===t)throw Error("undefined player");return t}function P(e,n){if("undefined"===typeof e.dieRoll)return[];var t=function(e,n){var t=e.players.find((function(e){return e.id===n}));if(void 0===t)throw Error("undefined player");return t}(e,n.currentPlayer);return e.pieces.map((function(n){var a=n.seat===t.seat?N(n.position,e.dieRoll,e.pieces):y.f;return{from:n.position,to:a}})).filter((function(e){return e.to!==y.f}))}var U={name:"seis",setup:function(){return T},moves:{rollDie:function(e,n,t){var a;return"undefined"!==typeof e.dieRoll?y.f:Object(E.a)({},e,{dieRoll:t||(null===(a=n.random)||void 0===a?void 0:a.D6())})},movePiece:function(e,n,t){if(void 0===e.dieRoll)return y.f;if(""===t){var a;if(!(null===(a=n.events)||void 0===a?void 0:a.endTurn))throw new Error("ctx.events.endTurn is undefined");return n.events.endTurn(),Object(E.a)({},e,{dieRoll:void 0})}var r;try{r=D(t,e.dieRoll,e.pieces)}catch(o){return y.f}if(!n.events||!n.events.endTurn)throw new Error("ctx.events is undefined");if(e.dieRoll<6){var i;if(!(null===(i=n.events)||void 0===i?void 0:i.endTurn))throw new Error("ctx.events.endTurn is undefined");n.events.endTurn()}return Object(E.a)({},e,{dieRoll:void 0,pieces:e.pieces.map((function(e){return j.a.has(r,e.position)?Object(E.a)({},e,{position:r[e.position]}):e}))})}},turn:{}},G=t(192),J=t(207),F=t(32),W=F.g,A={1:F.c,2:F.f,3:F.e,4:F.b,5:F.a,6:F.d},M=Object(G.a)((function(e){return Object(J.a)({root:{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,fontSize:"inherit",transition:e.transitions.create("fill",{duration:e.transitions.duration.shorter})}})})),H=function(e){var n=e.value,t=n?A[n]:W,a=M();return r.a.createElement(t,{className:a.root})},z=function(e){e.G,e.ctx;var n=e.player,t=e.position,a=e.enabled,i=e.onSelect,o=e.onActivate,c=e.onDeactivate;return r.a.createElement("div",{className:"Piece "+n.color+(a?" enabled":""),onClick:function(){(i||j.a.noop)(t)},onMouseEnter:function(){(o||j.a.noop)(t)},onMouseLeave:function(){(c||j.a.noop)(t)}})},q=t(197),L=t(195),$=t(198),K=t(94),Q=Object(G.a)((function(e){return{loading:{padding:e.spacing(2)},diceContainer:{display:"flex",justifyContent:"space-evenly",alignItems:"center",width:"80vw"},diceRandom:{flexBasis:"40%",display:"block",margin:0,padding:0,width:"20vw",height:"20vw",fontSize:"20vw"},diceWrapper:{flexBasis:"60%",width:"40vw",height:"20vw",display:"flex",flexFlow:"row wrap",alignItems:"center",justifyContent:"space-evenly"},diceButton:{flexBasis:"33%",flexGrow:0,display:"block",margin:0,padding:0,width:"10vw",height:"10vw",fontSize:"8vw"},main:{height:"100vh",width:"100vw",display:"flex",justifyContent:"center",alignItems:"center"},board:{position:"relative",display:"flex"},controls:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center"},"@media (orientation: portrait)":{main:{flexFlow:"column nowrap"},board:{height:"min(60vh, 100vw)",width:"min(60vh, 100vw)"},controls:{height:"40vh",width:"100vw"}},"@media (orientation: landscape)":{main:{flexFlow:"row nowrap"},board:{height:"min(60vw, 100vh)",width:"min(60vw, 100vh)"},controls:{height:"100vh",width:"40vw"}}}})),V=function(e){var n=e.G,t=e.ctx,i=e.moves,o=(e.playerID,e.isActive),c=Q(),s=Object(a.useState)(),l=Object(u.a)(s,2),d=l[0],f=l[1],m=function(e,n){var t=e.players.find((function(e){return e.id===n.currentPlayer}));if(void 0===t)throw Error("undefined player");return t}(n,t),p=P(n,t),v=p.find((function(e){return d&&d===e.from})),h=function(e){p.find((function(n){return n.from===e}))&&(i.movePiece(e),f(void 0))},w=function(e){f(e)},b=function(e){f(void 0)};return r.a.createElement("div",{className:"".concat(c.main," game-view current-player-").concat(m.seat)},r.a.createElement("div",{className:"".concat(c.board," board4")},j.a.flatten(j.a.range(4).map((function(e){return j.a.concat([],j.a.range(4).map((function(n){return C(e,n)})),j.a.range(12).map((function(n){return k(e,n)})),j.a.range(4).map((function(n){return O(e,n)})))}))).map((function(e){var a=n.pieces.find((function(n){return n.position===e})),i=(null===v||void 0===v?void 0:v.to)===e;return r.a.createElement("div",{key:e,className:"cell ".concat(e)},r.a.createElement("div",{className:"spot ".concat(i?"highlight":"")},a&&r.a.createElement(z,{G:n,ctx:t,player:B(n,a.seat),position:e,onSelect:o?h:void 0,onActivate:o?w:void 0,onDeactivate:o?b:void 0,enabled:o&&p.some(j.a.matches({from:e}))})))})),n.dieRoll&&r.a.createElement("div",{className:"dice-view dice-view-".concat(m.seat),style:{transform:"rotate(".concat((n.dieRoll+t.turn)%18*10,"deg)")}},r.a.createElement(H,{value:n.dieRoll}))),r.a.createElement(L.a,{className:c.controls},!(!o||!n.dieRoll||0!==p.length)&&r.a.createElement("div",null,r.a.createElement(K.a,null,"No moves"),r.a.createElement("div",null,r.a.createElement(q.a,{variant:"contained",onClick:function(){i.movePiece("")}},"Continue"))),o&&!n.dieRoll&&r.a.createElement("div",{className:c.diceContainer},r.a.createElement($.a,{className:c.diceRandom,onClick:function(e){i.rollDie()}},r.a.createElement(H,null)),r.a.createElement("div",{className:c.diceWrapper},r.a.createElement($.a,{className:c.diceButton,onClick:function(e){i.rollDie(1)}},r.a.createElement(H,{value:1})),r.a.createElement($.a,{className:c.diceButton,onClick:function(e){i.rollDie(2)}},r.a.createElement(H,{value:2})),r.a.createElement($.a,{className:c.diceButton,onClick:function(e){i.rollDie(3)}},r.a.createElement(H,{value:3})),r.a.createElement($.a,{className:c.diceButton,onClick:function(e){i.rollDie(4)}},r.a.createElement(H,{value:4})),r.a.createElement($.a,{className:c.diceButton,onClick:function(e){i.rollDie(5)}},r.a.createElement(H,{value:5})),r.a.createElement($.a,{className:c.diceButton,onClick:function(e){i.rollDie(6)}},r.a.createElement(H,{value:6}))))))},X=t(53),Y=t(21),Z=t(200),_=t(199),ee=t(203),ne=t(201),te=t(202),ae=t(206);var re=function(e){var n=e.open,t=e.onSubmit,i=function(e){var n=Object(a.useState)(e),t=Object(u.a)(n,2),r=t[0],i=t[1];return[r,function(e){i(Object(E.a)({},r,Object(Y.a)({},e.currentTarget.id,e.currentTarget.value)))}]}({roomID:"",name:""}),o=Object(u.a)(i,2),c=o[0],d=o[1],f=Object(a.useState)(!1),m=Object(u.a)(f,2),p=m[0],h=m[1],b=Object(a.useState)(),g=Object(u.a)(b,2),y=g[0],x=g[1];return r.a.createElement(_.a,{open:n},r.a.createElement(Z.a,null,"Join an online game"),r.a.createElement(ne.a,null,r.a.createElement(te.a,null,"Enter your name and a Game ID to join an online game."),r.a.createElement(ae.a,{required:!0,fullWidth:!0,id:"name",name:"name",label:"Name",autoFocus:!0,onChange:d,value:c.name,helperText:"The name you want to use in the game",disabled:p}),r.a.createElement(ae.a,{required:!0,fullWidth:!0,id:"roomID",name:"roomID",label:"Game ID",onChange:d,value:c.roomID,helperText:y||"Enter the 6 digit game ID",disabled:p})),r.a.createElement(ee.a,null,r.a.createElement(q.a,{onClick:function(){Object(l.a)(s.a.mark((function e(){var n,a,r,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),x(void 0),e.prev=2,e.next=5,v(c.roomID);case 5:n=e.sent,e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(2),h(!1),x("Game not found"),e.abrupt("return");case 13:a=Object(X.a)(n.players),e.prev=14,a.s();case 16:if((r=a.n()).done){e.next=34;break}if(!(i=r.value).name){e.next=20;break}return e.abrupt("continue",32);case 20:return e.prev=20,e.next=23,w(c.roomID,c.name,i.id);case 23:return o=e.sent,t({gameID:c.roomID,playerID:i.id+"",credentials:o}),h(!1),e.abrupt("return");case 29:return e.prev=29,e.t1=e.catch(20),e.abrupt("continue",32);case 32:e.next=16;break;case 34:e.next=39;break;case 36:e.prev=36,e.t2=e.catch(14),a.e(e.t2);case 39:return e.prev=39,a.f(),e.finish(39);case 42:h(!1),x("No open seats");case 44:case"end":return e.stop()}}),e,null,[[2,8],[14,36,39,42],[20,29]])})))()},color:"primary"},"Join")))},ie=t(205),oe=t(154),ce=t(204),se=t(153),le=Object(G.a)((function(e){return{main:{},loading:{padding:e.spacing(2)}}})),ue=function(){var e=le();return r.a.createElement(oe.a,{open:!0},r.a.createElement(se.a,{className:e.loading},r.a.createElement(ce.a,{color:"inherit"})))},de=Object(G.a)((function(e){return{main:{}}})),fe=function(e){var n=e.loading,t=void 0!==n&&n,i=e.children,o=de();return r.a.createElement(a.Fragment,null,r.a.createElement(ie.a,null),r.a.createElement("main",{className:o.main},t?r.a.createElement(ue,null):r.a.createElement(a.Fragment,null,i)))},me=(t(118),Object(f.a)({game:U,board:V,multiplayer:Object(d.b)({server:"https://seis-game.herokuapp.com"}),loading:ue})),pe=Object(f.a)({game:U,board:V}),ve=function(){var e=function(e){var n=Object(a.useState)((function(){try{return JSON.parse(sessionStorage.getItem(e)||"null")}catch(n){return}})),t=Object(u.a)(n,2),r=t[0],i=t[1];return Object(a.useEffect)((function(){r?sessionStorage.setItem(e,JSON.stringify(r)):sessionStorage.removeItem(e)}),[e,r]),[r,i]}("game"),n=Object(u.a)(e,2),t=n[0],i=n[1],o=Object(a.useState)(!1),c=Object(u.a)(o,2),d=c[0],f=c[1],m=window.location.hash.indexOf("debug")>0;return Object(a.useEffect)((function(){m||(f(!0),Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v(t.gameID);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),i(void 0);case 8:f(!1);case 9:case"end":return e.stop()}}),e,null,[[0,5]])})))())}),[m,t,i]),r.a.createElement(fe,{loading:d},m?r.a.createElement(pe,{debug:!1}):t?r.a.createElement(me,Object.assign({},t,{debug:!1})):r.a.createElement(re,{open:!0,onSubmit:i}))};o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ve,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[107,1,2]]]);
//# sourceMappingURL=main.323daf37.chunk.js.map