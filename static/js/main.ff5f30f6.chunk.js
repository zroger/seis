(this.webpackJsonpseis=this.webpackJsonpseis||[]).push([[0],{107:function(e,n,t){e.exports=t(152)},112:function(e,n,t){},118:function(e,n,t){},148:function(e,n){},152:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),o=t(14),i=t.n(o);t(112),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=t(8),l=t.n(c),u=t(11),s=t(19),f=t(61),d=t(74),m="10.0.1.27"===window.location.hostname?"http://10.0.1.27:8000":"https://seis-game.herokuapp.com";function p(e){return new Promise((function(n){return setTimeout(n,e)}))}function v(e){return h.apply(this,arguments)}function h(){return(h=Object(u.a)(l.a.mark((function e(n){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(m+"/games/seis/"+n);case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Room ".concat(n," not found"));case 5:return e.next=7,p(1e3);case 7:return e.next=9,t.json();case 9:return a=e.sent,e.abrupt("return",a);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,n,t){return g.apply(this,arguments)}function g(){return(g=Object(u.a)(l.a.mark((function e(n,t,a){var r,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(1e3);case 2:return e.next=4,fetch(m+"/games/seis/"+n+"/join",{method:"POST",body:JSON.stringify({playerID:a,playerName:t}),headers:{"Content-Type":"application/json"}});case 4:if((r=e.sent).ok){e.next=7;break}throw new Error("Unable to join room ".concat(n));case 7:return e.next=9,p(1e3);case 9:return e.next=11,r.json();case 11:return o=e.sent,e.abrupt("return",o.playerCredentials);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E,b=t(15),y=t(5),O=t(2),x=t(10),j=t.n(x);!function(e){e.CIRCUIT="C",e.HOME="H",e.START="S"}(E||(E={}));function S(e,n,t){return(e+n.toString(16)+t.toString(16)).toUpperCase()}var N=j.a.curry(S)(E.HOME),I=j.a.curry(S)(E.CIRCUIT),C=j.a.curry(S)(E.START);function k(e,n){var t,a={type:(t=e)[0],seat:parseInt(t[1],16),index:parseInt(t[2],16)};if(R(e))return I(a.seat,0);if(function(e){return"C"===e[0].toUpperCase()}(e)){if(a.index<11)return I(a.seat,a.index+1);var r=(a.seat+1)%4;return r===n?N(r,0):I(r,0)}return function(e){return"H"===e[0].toUpperCase()}(e)&&a.index<3?N(a.seat,a.index+1):O.f}function T(e,n,t){var a,r,o=t.find((function(n){return n.position===e}));if("undefined"===typeof o)throw new Error("No piece in that position");if(R(e)&&![1,6].includes(n))return O.f;try{if((a=j.a.range(n).reduce((function(e,n){var a=k(e,o.seat);if(a===O.f)throw O.f;if(function(e,n,t){return e.some(j.a.matches({position:t,seat:n}))}(t,o.seat,a))throw O.f;return a}),e))===e)return e}catch(i){return O.f}return"C"===(r=a)[0].toUpperCase()&&"5"===r[2]&&t.find((function(e){return a===e.position}))?O.f:a}function D(e,n,t){var a=T(e,n,t);if(a===O.f)throw new Error("invalid move");var r={};r[e]=a;var o=t.find(j.a.matches({position:a}));return o&&(r[o.position]=function(e,n){var t=j.a.first(j.a.difference(j.a.range(4).map((function(e){return C(n,e)})),e.map((function(e){return e.position}))));if(!t)throw new Error("cannot capture");return t}(t,o.seat)),r}function R(e){return"S"===e[0].toUpperCase()}function P(e,n){var t=e.players.find(j.a.matches({seat:n}));if(void 0===t)throw Error("undefined player");return t}function G(e,n){if("undefined"===typeof e.dieRoll)return[];var t=function(e,n){var t=e.players.find((function(e){return e.id===n}));if(void 0===t)throw Error("undefined player");return t}(e,n.currentPlayer);return e.pieces.map((function(n){var a=n.seat===t.seat?T(n.position,e.dieRoll,e.pieces):O.f;return{from:n.position,to:a}})).filter((function(e){return e.to!==O.f}))}var M,A={name:"seis",setup:function(){return{players:[],pieces:[]}},phases:{setup:{turn:{activePlayers:{all:O.B.NULL}},moves:{ChooseSeat:function(e,n,t,a){var r;if(e.players.some((function(e){return e.seat===t})))return O.f;e.players.push({seat:t,name:a,id:n.playerID,color:["red","blue","yellow","green"][t]}),(r=e.pieces).push.apply(r,Object(b.a)(j.a.range(4).map((function(e){return{seat:t,position:"S".concat(t).concat(e)}}))))}},start:!0,endIf:function(e,n){return e.players.length===n.numPlayers},next:"play"},play:{moves:{rollDie:function(e,n,t){var a;return"undefined"!==typeof e.dieRoll?O.f:Object(y.a)({},e,{dieRoll:t||(null===(a=n.random)||void 0===a?void 0:a.D6())})},movePiece:function(e,n,t){if(void 0===e.dieRoll)return O.f;if(""===t){var a;if(!(null===(a=n.events)||void 0===a?void 0:a.endTurn))throw new Error("ctx.events.endTurn is undefined");return n.events.endTurn(),Object(y.a)({},e,{dieRoll:void 0})}var r;try{r=D(t,e.dieRoll,e.pieces)}catch(i){return O.f}if(!n.events||!n.events.endTurn)throw new Error("ctx.events is undefined");if(e.dieRoll<6){var o;if(!(null===(o=n.events)||void 0===o?void 0:o.endTurn))throw new Error("ctx.events.endTurn is undefined");n.events.endTurn()}return Object(y.a)({},e,{dieRoll:void 0,pieces:e.pieces.map((function(e){return j.a.has(r,e.position)?Object(y.a)({},e,{position:r[e.position]}):e}))})}},turn:{order:{first:function(e,n){return 0},next:function(e,n){return(n.playOrderPos+1)%n.numPlayers},playOrder:function(e){return j.a.sortBy(e.players,["seat"]).map((function(e){return e.id}))}}}}},moves:{},turn:{}},B=t(193),_=t(207),L=t(32),z=L.g,U={1:L.c,2:L.f,3:L.e,4:L.b,5:L.a,6:L.d},H=Object(B.a)((function(e){return Object(_.a)({root:{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,fontSize:"inherit",transition:e.transitions.create("fill",{duration:e.transitions.duration.shorter})}})})),V=function(e){var n=e.value,t=n?U[n]:z,a=H();return r.a.createElement(t,{className:a.root})},F=t(196),J=Object(B.a)((function(e){return{root:{display:"flex",justifyContent:"space-evenly",alignItems:"center",width:"80vw"},left:{flexBasis:"40%",display:"block",margin:0,padding:0,width:"20vw",height:"20vw",fontSize:"20vw","& $button":{fontSize:"20vw"}},right:{flexBasis:"60%",width:"40vw",height:"20vw",display:"flex",flexFlow:"row wrap",alignItems:"center",justifyContent:"space-evenly","& $button":{fontSize:"8vw",flexBasis:"33%"}},button:{}}})),W=function(e){var n=e.onRoll,t=J(),a=function(e){return function(t){t.preventDefault(),n(e)}};return r.a.createElement("div",{className:t.root},r.a.createElement("div",{className:t.left},r.a.createElement(F.a,{className:t.button,onClick:a()},r.a.createElement(V,null))),r.a.createElement("div",{className:t.right},j.a.range(6).map((function(e){return r.a.createElement(F.a,{className:t.button,onClick:a(e+1)},r.a.createElement(V,{value:e+1}))}))))},$=function(e){e.G,e.ctx;var n=e.player,t=e.position,a=e.enabled,o=e.onSelect,i=e.onActivate,c=e.onDeactivate;return r.a.createElement("div",{className:"Piece "+n.color+(a?" enabled":""),onClick:function(){(o||j.a.noop)(t)},onMouseEnter:function(){(i||j.a.noop)(t)},onMouseLeave:function(){(c||j.a.noop)(t)}})},q=t(153),Y=t(198),K=Object(B.a)((function(e){return{root:{}}})),Q=function(e){var n=e.onSelect,t=e.players,a=K();return r.a.createElement(Y.a,{className:a.root,size:"large",variant:"contained"},["Red","Blue","Yellow","Green"].map((function(e,a){return r.a.createElement(q.a,{key:a,onClick:(o=a,function(e){e.preventDefault(),n(o)}),disabled:!!t.find((function(e){return e.seat===a}))},e);var o})))},X=t(95),Z=Object(B.a)((function(e){return{loading:{padding:e.spacing(2)},diceContainer:{display:"flex",justifyContent:"space-evenly",alignItems:"center",width:"80vw"},diceRandom:{flexBasis:"40%",display:"block",margin:0,padding:0,width:"20vw",height:"20vw",fontSize:"20vw"},diceWrapper:{flexBasis:"60%",width:"40vw",height:"20vw",display:"flex",flexFlow:"row wrap",alignItems:"center",justifyContent:"space-evenly"},diceButton:{flexBasis:"33%",flexGrow:0,display:"block",margin:0,padding:0,width:"10vw",height:"10vw",fontSize:"8vw"},main:{height:"100vh",width:"100vw",display:"flex",justifyContent:"center",alignItems:"center"},board:{position:"relative",display:"flex"},controls:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center"},name:{position:"absolute",textAlign:"center","&.seat-0":{transform:"rotate(45deg)",bottom:"77.5%",left:"55%"},"&.seat-1":{transform:"rotate(-45deg)",top:"77.5%",left:"55%"},"&.seat-2":{transform:"rotate(45deg)",top:"77.5%",right:"55%"},"&.seat-3":{transform:"rotate(-45deg)",bottom:"77.5%",right:"55%"}},"@media (orientation: portrait)":{main:{flexFlow:"column nowrap"},board:{height:"min(60vh, 100vw)",width:"min(60vh, 100vw)"},controls:{height:"40vh",width:"100vw"},name:{fontSize:"min(2vh, 3.33vw)",width:"min(30vh, 50vw)"}},"@media (orientation: landscape)":{main:{flexFlow:"row nowrap"},board:{height:"min(60vw, 100vh)",width:"min(60vw, 100vh)"},controls:{height:"100vh",width:"40vw"},name:{fontSize:"min(3.33vh, 2vw)",width:"min(50vh, 30vw)"}}}}));!function(e){e[e.NONE=0]="NONE",e[e.CHOOSE_SEAT=1]="CHOOSE_SEAT",e[e.PENDING_START=2]="PENDING_START",e[e.ROLL=3]="ROLL",e[e.MOVE=4]="MOVE",e[e.PENDING_MOVE=5]="PENDING_MOVE"}(M||(M={}));var ee=function(e){var n=e.G,t=e.ctx,o=e.moves,i=e.playerID,c=e.isActive,l=e.gameMetadata,u=Z(),f=Object(a.useState)(),d=Object(s.a)(f,2),m=d[0],p=d[1],v=function(e,n){var t=e.players.find((function(e){return e.id===n.currentPlayer}));if(void 0!==t)return t}(n,t),h=G(n,t),w=h.find((function(e){return m&&m===e.from})),g=function(e,n,t,a){return"setup"===n.phase?e.players.find((function(e){return e.id===t}))?M.PENDING_START:M.CHOOSE_SEAT:"play"===n.phase&&a?e.dieRoll?M.MOVE:M.ROLL:"play"===n.phase?M.PENDING_MOVE:M.NONE}(n,t,i,c),E=function(e){h.find((function(n){return n.from===e}))&&(o.movePiece(e),p(void 0))},b=function(e){p(e)},y=function(e){p(void 0)};return r.a.createElement("div",{className:"".concat(u.main," game-view current-player-").concat(null===v||void 0===v?void 0:v.seat)},r.a.createElement("div",{className:"".concat(u.board," board4")},n.players.map((function(e){return r.a.createElement("div",{key:e.seat,className:"".concat(u.name," seat-").concat(e.seat)},e.name)})),j.a.flatten(j.a.range(4).map((function(e){return j.a.concat([],j.a.range(4).map((function(n){return C(e,n)})),j.a.range(12).map((function(n){return I(e,n)})),j.a.range(4).map((function(n){return N(e,n)})))}))).map((function(e){var a=n.pieces.find((function(n){return n.position===e})),o=(null===w||void 0===w?void 0:w.to)===e;return r.a.createElement("div",{key:e,className:"cell ".concat(e)},r.a.createElement("div",{className:"spot ".concat(o?"highlight":"")},a&&r.a.createElement($,{G:n,ctx:t,player:P(n,a.seat),position:e,onSelect:c?E:void 0,onActivate:c?b:void 0,onDeactivate:c?y:void 0,enabled:c&&h.some(j.a.matches({from:e}))})))})),n.dieRoll&&r.a.createElement("div",{className:"dice-view dice-view-".concat(null===v||void 0===v?void 0:v.seat),style:{transform:"rotate(".concat((n.dieRoll+t.turn)%18*10,"deg)")}},r.a.createElement(V,{value:n.dieRoll}))),r.a.createElement("div",{className:u.controls},g===M.CHOOSE_SEAT&&r.a.createElement(Q,{onSelect:function(e){var n=l.find((function(e){return""+e.id===i}));o.ChooseSeat(e,(null===n||void 0===n?void 0:n.name)?n.name:"Player ".concat(e+1))},players:n.players}),g===M.PENDING_START&&r.a.createElement("div",null,"Waiting for ",t.numPlayers-n.players.length," more to join..."),g===M.MOVE&&(h.length>0?r.a.createElement("div",null,"Make a move..."):r.a.createElement("div",null,r.a.createElement(X.a,null,"No moves"),r.a.createElement("div",null,r.a.createElement(q.a,{variant:"contained",onClick:function(){o.movePiece("")}},"Continue")))),g===M.ROLL&&r.a.createElement(W,{onRoll:o.rollDie}),g===M.PENDING_MOVE&&r.a.createElement("div",null,"Waiting for ",r.a.createElement("strong",null,null===v||void 0===v?void 0:v.name)," to move..."),g===M.NONE&&r.a.createElement("div",null,"lolwut")))},ne=t(54),te=t(21),ae=t(200),re=t(199),oe=t(203),ie=t(201),ce=t(202),le=t(206);var ue=function(e){var n=e.open,t=e.onSubmit,o=function(e){var n=Object(a.useState)(e),t=Object(s.a)(n,2),r=t[0],o=t[1];return[r,function(e){o(Object(y.a)({},r,Object(te.a)({},e.currentTarget.id,e.currentTarget.value)))}]}({roomID:"",name:""}),i=Object(s.a)(o,2),c=i[0],f=i[1],d=Object(a.useState)(!1),m=Object(s.a)(d,2),p=m[0],h=m[1],g=Object(a.useState)(),E=Object(s.a)(g,2),b=E[0],O=E[1];return r.a.createElement(re.a,{open:n},r.a.createElement(ae.a,null,"Join an online game"),r.a.createElement(ie.a,null,r.a.createElement(ce.a,null,"Enter your name and a Game ID to join an online game."),r.a.createElement(le.a,{required:!0,fullWidth:!0,id:"name",name:"name",label:"Name",autoFocus:!0,onChange:f,value:c.name,helperText:"The name you want to use in the game",disabled:p}),r.a.createElement(le.a,{required:!0,fullWidth:!0,id:"roomID",name:"roomID",label:"Game ID",onChange:f,value:c.roomID,helperText:b||"Enter the 6 digit game ID",disabled:p})),r.a.createElement(oe.a,null,r.a.createElement(q.a,{onClick:function(){Object(u.a)(l.a.mark((function e(){var n,a,r,o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),O(void 0),e.prev=2,e.next=5,v(c.roomID);case 5:n=e.sent,e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(2),h(!1),O("Game not found"),e.abrupt("return");case 13:a=Object(ne.a)(n.players),e.prev=14,a.s();case 16:if((r=a.n()).done){e.next=34;break}if(!(o=r.value).name){e.next=20;break}return e.abrupt("continue",32);case 20:return e.prev=20,e.next=23,w(c.roomID,c.name,o.id);case 23:return i=e.sent,t({gameID:c.roomID,playerID:o.id+"",credentials:i}),h(!1),e.abrupt("return");case 29:return e.prev=29,e.t1=e.catch(20),e.abrupt("continue",32);case 32:e.next=16;break;case 34:e.next=39;break;case 36:e.prev=36,e.t2=e.catch(14),a.e(e.t2);case 39:return e.prev=39,a.f(),e.finish(39);case 42:h(!1),O("No open seats");case 44:case"end":return e.stop()}}),e,null,[[2,8],[14,36,39,42],[20,29]])})))()},color:"primary"},"Join")))},se=t(205),fe=t(155),de=t(204),me=t(154),pe=Object(B.a)((function(e){return{main:{},loading:{padding:e.spacing(2)}}})),ve=function(){var e=pe();return r.a.createElement(fe.a,{open:!0},r.a.createElement(me.a,{className:e.loading},r.a.createElement(de.a,{color:"inherit"})))},he=Object(B.a)((function(e){return{main:{}}})),we=function(e){var n=e.loading,t=void 0!==n&&n,o=e.children,i=he();return r.a.createElement(a.Fragment,null,r.a.createElement(se.a,null),r.a.createElement("main",{className:i.main},t?r.a.createElement(ve,null):r.a.createElement(a.Fragment,null,o)))},ge=(t(118),Object(d.a)({game:A,board:ee,multiplayer:Object(f.b)({server:m}),loading:ve})),Ee=Object(d.a)({game:A,board:ee}),be=function(){var e=function(e){var n=Object(a.useState)((function(){try{return JSON.parse(sessionStorage.getItem(e)||"null")}catch(n){return}})),t=Object(s.a)(n,2),r=t[0],o=t[1];return Object(a.useEffect)((function(){r?sessionStorage.setItem(e,JSON.stringify(r)):sessionStorage.removeItem(e)}),[e,r]),[r,o]}("game"),n=Object(s.a)(e,2),t=n[0],o=n[1],i=Object(a.useState)(!1),c=Object(s.a)(i,2),f=c[0],d=c[1],m=window.location.hash.indexOf("debug")>0;return Object(a.useEffect)((function(){m||(d(!0),Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v(t.gameID);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),o(void 0);case 8:d(!1);case 9:case"end":return e.stop()}}),e,null,[[0,5]])})))())}),[m,t,o]),r.a.createElement(we,{loading:f},m?r.a.createElement(Ee,{debug:!1}):t?r.a.createElement(ge,Object.assign({},t,{debug:!1})):r.a.createElement(ue,{open:!0,onSubmit:o}))};i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(be,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[107,1,2]]]);
//# sourceMappingURL=main.ff5f30f6.chunk.js.map