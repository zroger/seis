(this.webpackJsonpseis=this.webpackJsonpseis||[]).push([[0],{107:function(e,t,n){e.exports=n(152)},112:function(e,t,n){},118:function(e,t,n){},148:function(e,t){},152:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(14),o=n.n(i);n(112),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=n(8),s=n.n(c),u=n(10),l=n(19),f=n(61),d=n(73),m="https://seis-game.herokuapp.com";function p(e){return new Promise((function(t){return setTimeout(t,e)}))}function v(e){return h.apply(this,arguments)}function h(){return(h=Object(u.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(m+"/games/seis/"+t);case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("Room ".concat(t," not found"));case 5:return e.next=7,p(1e3);case 7:return e.next=9,n.json();case 9:return a=e.sent,e.abrupt("return",a);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,t,n){return b.apply(this,arguments)}function b(){return(b=Object(u.a)(s.a.mark((function e(t,n,a){var r,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(1e3);case 2:return e.next=4,fetch(m+"/games/seis/"+t+"/join",{method:"POST",body:JSON.stringify({playerID:a,playerName:n}),headers:{"Content-Type":"application/json"}});case 4:if((r=e.sent).ok){e.next=7;break}throw new Error("Unable to join room ".concat(t));case 7:return e.next=9,p(1e3);case 9:return e.next=11,r.json();case 11:return i=e.sent,e.abrupt("return",i.playerCredentials);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var g,y=n(4),E=n(2),x=n(11),j=n.n(x);!function(e){e.CIRCUIT="C",e.HOME="H",e.START="S"}(g||(g={}));function S(e,t,n){return(e+t.toString(16)+n.toString(16)).toUpperCase()}var O=j.a.curry(S)(g.HOME),k=j.a.curry(S)(g.CIRCUIT),I=j.a.curry(S)(g.START);function C(e,t){var n,a={type:(n=e)[0],seat:parseInt(n[1],16),index:parseInt(n[2],16)};if(D(e))return k(a.seat,0);if(function(e){return"C"===e[0].toUpperCase()}(e)){if(a.index<11)return k(a.seat,a.index+1);var r=(a.seat+1)%4;return r===t?O(r,0):k(r,0)}return function(e){return"H"===e[0].toUpperCase()}(e)&&a.index<3?O(a.seat,a.index+1):E.f}function N(e,t,n){var a,r,i=n.find((function(t){return t.position===e}));if("undefined"===typeof i)throw new Error("No piece in that position");if(D(e)&&![1,6].includes(t))return E.f;try{if((a=j.a.range(t).reduce((function(e,t){var a=C(e,i.seat);if(a===E.f)throw E.f;if(function(e,t,n){return e.some(j.a.matches({position:n,seat:t}))}(n,i.seat,a))throw E.f;return a}),e))===e)return e}catch(o){return E.f}return"C"===(r=a)[0].toUpperCase()&&"5"===r[2]&&n.find((function(e){return a===e.position}))?E.f:a}function R(e,t,n){var a=N(e,t,n);if(a===E.f)throw new Error("invalid move");var r={};r[e]=a;var i=n.find(j.a.matches({position:a}));return i&&(r[i.position]=function(e,t){var n=j.a.first(j.a.difference(j.a.range(4).map((function(e){return I(t,e)})),e.map((function(e){return e.position}))));if(!n)throw new Error("cannot capture");return n}(n,i.seat)),r}function D(e){return"S"===e[0].toUpperCase()}var T={pieces:[{seat:0,position:"S00"},{seat:0,position:"S01"},{seat:0,position:"S02"},{seat:0,position:"S03"},{seat:1,position:"S10"},{seat:1,position:"S11"},{seat:1,position:"S12"},{seat:1,position:"S13"},{seat:2,position:"S20"},{seat:2,position:"S21"},{seat:2,position:"S22"},{seat:2,position:"S23"},{seat:3,position:"S30"},{seat:3,position:"S31"},{seat:3,position:"S32"},{seat:3,position:"S33"}],players:[{id:"0",seat:0,name:"Player 1",color:"red"},{id:"1",seat:1,name:"Player 2",color:"blue"},{id:"2",seat:2,name:"Player 3",color:"yellow"},{id:"3",seat:3,name:"Player 4",color:"green"}]};function P(e,t){var n=e.players.find(j.a.matches({seat:t}));if(void 0===n)throw Error("undefined player");return n}function B(e,t){if("undefined"===typeof e.dieRoll)return[];var n=function(e,t){var n=e.players.find((function(e){return e.id===t}));if(void 0===n)throw Error("undefined player");return n}(e,t.currentPlayer);return e.pieces.map((function(t){var a=t.seat===n.seat?N(t.position,e.dieRoll,e.pieces):E.f;return{from:t.position,to:a}})).filter((function(e){return e.to!==E.f}))}var U={name:"seis",setup:function(){return T},moves:{rollDie:function(e,t,n){var a;return"undefined"!==typeof e.dieRoll?E.f:Object(y.a)({},e,{dieRoll:n||(null===(a=t.random)||void 0===a?void 0:a.D6())})},movePiece:function(e,t,n){if(void 0===e.dieRoll)return E.f;if(""===n){var a;if(!(null===(a=t.events)||void 0===a?void 0:a.endTurn))throw new Error("ctx.events.endTurn is undefined");return t.events.endTurn(),Object(y.a)({},e,{dieRoll:void 0})}var r;try{r=R(n,e.dieRoll,e.pieces)}catch(o){return E.f}if(!t.events||!t.events.endTurn)throw new Error("ctx.events is undefined");if(e.dieRoll<6){var i;if(!(null===(i=t.events)||void 0===i?void 0:i.endTurn))throw new Error("ctx.events.endTurn is undefined");t.events.endTurn()}return Object(y.a)({},e,{dieRoll:void 0,pieces:e.pieces.map((function(e){return j.a.has(r,e.position)?Object(y.a)({},e,{position:r[e.position]}):e}))})}},turn:{}},F=n(192),G=n(207),J=n(32),z=J.g,A={1:J.c,2:J.f,3:J.e,4:J.b,5:J.a,6:J.d},M=Object(F.a)((function(e){return Object(G.a)({root:{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,fontSize:"inherit",transition:e.transitions.create("fill",{duration:e.transitions.duration.shorter})}})})),W=function(e){var t=e.value,n=t?A[t]:z,a=M();return r.a.createElement(n,{className:a.root})},H=n(195),$=Object(F.a)((function(e){return{root:{display:"flex",justifyContent:"space-evenly",alignItems:"center",width:"80vw"},left:{flexBasis:"40%",display:"block",margin:0,padding:0,width:"20vw",height:"20vw",fontSize:"20vw","& $button":{fontSize:"20vw"}},right:{flexBasis:"60%",width:"40vw",height:"20vw",display:"flex",flexFlow:"row wrap",alignItems:"center",justifyContent:"space-evenly","& $button":{fontSize:"8vw",flexBasis:"33%"}},button:{}}})),q=function(e){var t=e.onRoll,n=$(),a=function(e){return function(n){n.preventDefault(),t(e)}};return r.a.createElement("div",{className:n.root},r.a.createElement("div",{className:n.left},r.a.createElement(H.a,{className:n.button,onClick:a()},r.a.createElement(W,null))),r.a.createElement("div",{className:n.right},j.a.range(6).map((function(e){return r.a.createElement(H.a,{className:n.button,onClick:a(e+1)},r.a.createElement(W,{value:e+1}))}))))},L=function(e){e.G,e.ctx;var t=e.player,n=e.position,a=e.enabled,i=e.onSelect,o=e.onActivate,c=e.onDeactivate;return r.a.createElement("div",{className:"Piece "+t.color+(a?" enabled":""),onClick:function(){(i||j.a.noop)(n)},onMouseEnter:function(){(o||j.a.noop)(n)},onMouseLeave:function(){(c||j.a.noop)(n)}})},K=n(198),Q=n(197),V=n(94),X=Object(F.a)((function(e){return{loading:{padding:e.spacing(2)},diceContainer:{display:"flex",justifyContent:"space-evenly",alignItems:"center",width:"80vw"},diceRandom:{flexBasis:"40%",display:"block",margin:0,padding:0,width:"20vw",height:"20vw",fontSize:"20vw"},diceWrapper:{flexBasis:"60%",width:"40vw",height:"20vw",display:"flex",flexFlow:"row wrap",alignItems:"center",justifyContent:"space-evenly"},diceButton:{flexBasis:"33%",flexGrow:0,display:"block",margin:0,padding:0,width:"10vw",height:"10vw",fontSize:"8vw"},main:{height:"100vh",width:"100vw",display:"flex",justifyContent:"center",alignItems:"center"},board:{position:"relative",display:"flex"},controls:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center"},"@media (orientation: portrait)":{main:{flexFlow:"column nowrap"},board:{height:"min(60vh, 100vw)",width:"min(60vh, 100vw)"},controls:{height:"40vh",width:"100vw"}},"@media (orientation: landscape)":{main:{flexFlow:"row nowrap"},board:{height:"min(60vw, 100vh)",width:"min(60vw, 100vh)"},controls:{height:"100vh",width:"40vw"}}}})),Y=function(e){var t=e.G,n=e.ctx,i=e.moves,o=(e.playerID,e.isActive),c=X(),s=Object(a.useState)(),u=Object(l.a)(s,2),f=u[0],d=u[1],m=function(e,t){var n=e.players.find((function(e){return e.id===t.currentPlayer}));if(void 0===n)throw Error("undefined player");return n}(t,n),p=B(t,n),v=p.find((function(e){return f&&f===e.from})),h=function(e){p.find((function(t){return t.from===e}))&&(i.movePiece(e),d(void 0))},w=function(e){d(e)},b=function(e){d(void 0)};return r.a.createElement("div",{className:"".concat(c.main," game-view current-player-").concat(m.seat)},r.a.createElement("div",{className:"".concat(c.board," board4")},j.a.flatten(j.a.range(4).map((function(e){return j.a.concat([],j.a.range(4).map((function(t){return I(e,t)})),j.a.range(12).map((function(t){return k(e,t)})),j.a.range(4).map((function(t){return O(e,t)})))}))).map((function(e){var a=t.pieces.find((function(t){return t.position===e})),i=(null===v||void 0===v?void 0:v.to)===e;return r.a.createElement("div",{key:e,className:"cell ".concat(e)},r.a.createElement("div",{className:"spot ".concat(i?"highlight":"")},a&&r.a.createElement(L,{G:t,ctx:n,player:P(t,a.seat),position:e,onSelect:o?h:void 0,onActivate:o?w:void 0,onDeactivate:o?b:void 0,enabled:o&&p.some(j.a.matches({from:e}))})))})),t.dieRoll&&r.a.createElement("div",{className:"dice-view dice-view-".concat(m.seat),style:{transform:"rotate(".concat((t.dieRoll+n.turn)%18*10,"deg)")}},r.a.createElement(W,{value:t.dieRoll}))),r.a.createElement(Q.a,{className:c.controls},!(!o||!t.dieRoll||0!==p.length)&&r.a.createElement("div",null,r.a.createElement(V.a,null,"No moves"),r.a.createElement("div",null,r.a.createElement(K.a,{variant:"contained",onClick:function(){i.movePiece("")}},"Continue"))),o&&!t.dieRoll&&r.a.createElement(q,{onRoll:i.rollDie})))},Z=n(54),_=n(21),ee=n(200),te=n(199),ne=n(203),ae=n(201),re=n(202),ie=n(206);var oe=function(e){var t=e.open,n=e.onSubmit,i=function(e){var t=Object(a.useState)(e),n=Object(l.a)(t,2),r=n[0],i=n[1];return[r,function(e){i(Object(y.a)({},r,Object(_.a)({},e.currentTarget.id,e.currentTarget.value)))}]}({roomID:"",name:""}),o=Object(l.a)(i,2),c=o[0],f=o[1],d=Object(a.useState)(!1),m=Object(l.a)(d,2),p=m[0],h=m[1],b=Object(a.useState)(),g=Object(l.a)(b,2),E=g[0],x=g[1];return r.a.createElement(te.a,{open:t},r.a.createElement(ee.a,null,"Join an online game"),r.a.createElement(ae.a,null,r.a.createElement(re.a,null,"Enter your name and a Game ID to join an online game."),r.a.createElement(ie.a,{required:!0,fullWidth:!0,id:"name",name:"name",label:"Name",autoFocus:!0,onChange:f,value:c.name,helperText:"The name you want to use in the game",disabled:p}),r.a.createElement(ie.a,{required:!0,fullWidth:!0,id:"roomID",name:"roomID",label:"Game ID",onChange:f,value:c.roomID,helperText:E||"Enter the 6 digit game ID",disabled:p})),r.a.createElement(ne.a,null,r.a.createElement(K.a,{onClick:function(){Object(u.a)(s.a.mark((function e(){var t,a,r,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),x(void 0),e.prev=2,e.next=5,v(c.roomID);case 5:t=e.sent,e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(2),h(!1),x("Game not found"),e.abrupt("return");case 13:a=Object(Z.a)(t.players),e.prev=14,a.s();case 16:if((r=a.n()).done){e.next=34;break}if(!(i=r.value).name){e.next=20;break}return e.abrupt("continue",32);case 20:return e.prev=20,e.next=23,w(c.roomID,c.name,i.id);case 23:return o=e.sent,n({gameID:c.roomID,playerID:i.id+"",credentials:o}),h(!1),e.abrupt("return");case 29:return e.prev=29,e.t1=e.catch(20),e.abrupt("continue",32);case 32:e.next=16;break;case 34:e.next=39;break;case 36:e.prev=36,e.t2=e.catch(14),a.e(e.t2);case 39:return e.prev=39,a.f(),e.finish(39);case 42:h(!1),x("No open seats");case 44:case"end":return e.stop()}}),e,null,[[2,8],[14,36,39,42],[20,29]])})))()},color:"primary"},"Join")))},ce=n(205),se=n(154),ue=n(204),le=n(153),fe=Object(F.a)((function(e){return{main:{},loading:{padding:e.spacing(2)}}})),de=function(){var e=fe();return r.a.createElement(se.a,{open:!0},r.a.createElement(le.a,{className:e.loading},r.a.createElement(ue.a,{color:"inherit"})))},me=Object(F.a)((function(e){return{main:{}}})),pe=function(e){var t=e.loading,n=void 0!==t&&t,i=e.children,o=me();return r.a.createElement(a.Fragment,null,r.a.createElement(ce.a,null),r.a.createElement("main",{className:o.main},n?r.a.createElement(de,null):r.a.createElement(a.Fragment,null,i)))},ve=(n(118),Object(d.a)({game:U,board:Y,multiplayer:Object(f.b)({server:"https://seis-game.herokuapp.com"}),loading:de})),he=Object(d.a)({game:U,board:Y}),we=function(){var e=function(e){var t=Object(a.useState)((function(){try{return JSON.parse(sessionStorage.getItem(e)||"null")}catch(t){return}})),n=Object(l.a)(t,2),r=n[0],i=n[1];return Object(a.useEffect)((function(){r?sessionStorage.setItem(e,JSON.stringify(r)):sessionStorage.removeItem(e)}),[e,r]),[r,i]}("game"),t=Object(l.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)(!1),c=Object(l.a)(o,2),f=c[0],d=c[1],m=window.location.hash.indexOf("debug")>0;return Object(a.useEffect)((function(){m||(d(!0),Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v(n.gameID);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),i(void 0);case 8:d(!1);case 9:case"end":return e.stop()}}),e,null,[[0,5]])})))())}),[m,n,i]),r.a.createElement(pe,{loading:f},m?r.a.createElement(he,{debug:!1}):n?r.a.createElement(ve,Object.assign({},n,{debug:!1})):r.a.createElement(oe,{open:!0,onSubmit:i}))};o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(we,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[107,1,2]]]);
//# sourceMappingURL=main.3e802ad7.chunk.js.map